{"version":3,"file":"static/webpack/static/development/pages/index.js.a8c3152a31d574b43374.hot-update.js","sources":["webpack:///./components/search/Search.tsx"],"sourcesContent":["import styled from 'styled-components'\nimport { useState, useEffect } from 'react'\nimport {DebounceInput} from 'react-debounce-input'\nimport axios from 'axios'\nimport { Event } from '../../pages/e/event.types'\nimport EventThumbnail from '../event/EventThumbnail'\nimport { JSXElement } from '@babel/types'\nconst SearchWrapper = styled.div`\n`\n\nconst SearchParamButton = styled.div<{isSelected: boolean}>`\n  display: grid;\n  justify-content: center;\n  place-items: center;\n  font-weight: bold;\n  border: 1px solid black;\n  background: ${(props) => props.isSelected ? 'aqua' : 'none'};\n`\n\nconst SearchInput = styled(DebounceInput)`\n  width: 50%;\n  border: 1px solid black;\n`\n\nconst PageNumberButtonWrapper = styled.div`\n  display: flex;\n  justify-content: space-around;\n`\n\n\n\nconst Search = () => {\n  const [pageNo, selectPageNo] = useState(1)\n  const [pageSize, setPageSize] = useState(5)\n  const [searchQ, setSearchQ] = useState('')\n  const [allEvents, setEvents] = useState<Event[]>([])\n  const [isLoading, setLoading] = useState(false)\n  const [isError, setError] = useState(false)\n  const [eventsNo, setEventsNo] = useState(0)\n  const [totalPages, setTotalPages] = useState(1)\n\n  /**\n   * the API does not return total number of items so in order to create proper pagination this have to be done manually\n   */\n  const createPagination = async () => {\n    let data = [];\n    let page = 1;\n    while(true) {\n      const r = await axios.get(`https://mock-api.drinks.test.siliconrhino.io/events?page=${page}&pageSize=20`);\n      page++;\n      data.push(...r.data);\n      if(r.data.length === 0) {\n        setEventsNo(data.length)\n        break;\n      }\n    }\n    setTotalPages(Math.floor(eventsNo / pageSize))\n  }\n\n  useEffect(() => {\n    createPagination();\n  }, [])\n\n  useEffect(() => {\n    getEvents()\n  }, [pageSize, pageNo, searchQ])\n\n  useEffect(() => {\n    setTotalPages(Math.floor(eventsNo / pageSize))\n  }, [pageSize])\n\n  const getEvents = async () => {\n    setLoading(true)\n    try {\n      const res = await axios.get(`https://mock-api.drinks.test.siliconrhino.io/events?page=${pageNo}&pageSize=${pageSize}&search=${searchQ}`)\n      const evnts: Event[] = res.data\n      setEvents(evnts)\n      setLoading(false)\n    }\n    catch (err) {\n      setLoading(false)\n      setError(true)\n    }\n  }\n\n  useEffect(() => {}, [])\n  if (isError) {\n    return (\n      <div>Failed to load data.</div>\n    )\n  }\n\n  const pageButtons = (pageNumber: number) => {\n    let buttons: JSX.Element[] = []\n    for (let i = 0; i < pageNumber; i ++) {\n      buttons.push(\n        <SearchParamButton isSelected={pageNo === i} onClick={() => selectPageNo(i)}>{i}</SearchParamButton>\n      )\n    }\n    return buttons\n  }\n\n  return (\n    <SearchWrapper>\n      <SearchInput\n        minLength={1}\n        debounceTimeout={300}\n        placeholder={'asdf'}\n        //@ts-ignore\n        onChange={event => setSearchQ(event.target.value)}\n      />\n      <div>events: </div>\n      {\n        isLoading ?\n        <div>loading...</div>\n      :\n        allEvents.map((event) => (\n          <EventThumbnail\n            key={event.id}\n            id={event.id}\n            time={event.time}\n            title={event.title}\n            creator={event.creator}\n            guests={event.guests}\n            type={event.type}\n            location={event.location}\n            comments={event.comments}\n          />\n        ))\n      }\n      <PageNumberButtonWrapper>\n        <div>Select page:</div>\n        {pageButtons()}\n        <div>Items per page:</div>\n        <SearchParamButton isSelected={pageSize === 5} onClick={() => setPageSize(5)}>5</SearchParamButton>\n        <SearchParamButton isSelected={pageSize === 15} onClick={() => setPageSize(15)}>15</SearchParamButton>\n        <SearchParamButton isSelected={pageSize === 22} onClick={() => setPageSize(25)}>25</SearchParamButton>\n      </PageNumberButtonWrapper>\n    </SearchWrapper>\n  )\n}\n\nexport default Search"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAEA;AAEA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAMA;AAAA;AAGA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AACA;AAMA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAUA;;;;;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAHA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAIA;AACA;AACA;AACA;AAPA;AAAA;AAAA;AAAA;AACA;AAOA;AARA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAYA;AACA;AAbA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAcA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAGA;AACA;AACA;AACA;AANA;AAAA;AACA;AADA;AAAA;AAAA;AASA;AACA;AACA;AAXA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAaA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAFA;AAGA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAJA;AACA;AACA;AAAA;AAIA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAHA;AAKA;AAAA;AAAA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAcA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;;;;A","sourceRoot":""}
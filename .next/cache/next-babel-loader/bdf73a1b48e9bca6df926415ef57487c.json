{"ast":null,"code":"var _jsxFileName = \"/Users/mj/repo/siliconrhino/components/search/Search.tsx\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport styled from 'styled-components';\nimport { useState, useEffect } from 'react';\nimport { DebounceInput } from 'react-debounce-input';\nimport axios from 'axios';\nimport EventThumbnail from '../event/EventThumbnail';\nconst SearchWrapper = styled.div.withConfig({\n  displayName: \"Search__SearchWrapper\",\n  componentId: \"sc-1flz1c3-0\"\n})([\"\"]);\nconst SearchParamButton = styled.div.withConfig({\n  displayName: \"Search__SearchParamButton\",\n  componentId: \"sc-1flz1c3-1\"\n})([\"display:grid;justify-content:center;place-items:center;font-weight:bold;border:1px solid black;background:\", \";\"], props => props.isSelected ? 'aqua' : 'none');\nconst SearchInput = styled(DebounceInput).withConfig({\n  displayName: \"Search__SearchInput\",\n  componentId: \"sc-1flz1c3-2\"\n})([\"width:50%;border:1px solid black;\"]);\nconst PageNumberButtonWrapper = styled.div.withConfig({\n  displayName: \"Search__PageNumberButtonWrapper\",\n  componentId: \"sc-1flz1c3-3\"\n})([\"display:flex;justify-content:space-around;\"]);\n\nconst Search = () => {\n  const {\n    0: pageNo,\n    1: selectPageNo\n  } = useState(0);\n  const {\n    0: pageSize,\n    1: setPageSize\n  } = useState(5);\n  const {\n    0: searchQ,\n    1: setSearchQ\n  } = useState('');\n  const {\n    0: allEvents,\n    1: setEvents\n  } = useState([]);\n  const {\n    0: isLoading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: isError,\n    1: setError\n  } = useState(false);\n  const {\n    0: eventsNo,\n    1: setEventsNo\n  } = useState(0);\n  const {\n    0: totalPages,\n    1: setTotalPages\n  } = useState(1);\n  /**\n   * the API does not return total number of items so in order to create proper pagination this have to be done manually\n   */\n\n  const createPagination = async () => {\n    let data = [];\n    let page = 1;\n\n    while (true) {\n      const r = await axios.get(`https://mock-api.drinks.test.siliconrhino.io/events?page=${page}&pageSize=5`);\n      page++;\n      data.push(...r.data);\n\n      if (r.data.length === 0) {\n        setEventsNo(data.length);\n        break;\n      }\n    }\n\n    setTotalPages(Math.floor(eventsNo / pageSize) + 1);\n  };\n\n  useEffect(() => {\n    createPagination();\n  }, []);\n  useEffect(() => {\n    getEvents();\n  }, [pageSize, pageNo, searchQ]);\n  useEffect(() => {\n    setTotalPages(Math.floor(eventsNo / pageSize) + 1);\n  }, [pageSize]);\n\n  const getEvents = async () => {\n    setLoading(true);\n\n    try {\n      const res = await axios.get(`https://mock-api.drinks.test.siliconrhino.io/events?page=${pageNo}&pageSize=${pageSize}&search=${searchQ}`);\n      const evnts = res.data;\n      setEvents(evnts);\n      setLoading(false);\n    } catch (err) {\n      setLoading(false);\n      setError(true);\n    }\n  };\n\n  useEffect(() => {}, []);\n\n  if (isError) {\n    return __jsx(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, \"Failed to load data.\");\n  }\n\n  const pageButtons = () => {\n    let buttons = [];\n\n    for (let i = 0; i < totalPages; i++) {\n      buttons.push(__jsx(SearchParamButton, {\n        isSelected: pageNo === i,\n        onClick: () => selectPageNo(i),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }, i + 1));\n    }\n\n    return buttons;\n  };\n\n  return __jsx(SearchWrapper, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }, __jsx(SearchInput, {\n    minLength: 1,\n    debounceTimeout: 300,\n    placeholder: 'asdf' //@ts-ignore\n    ,\n    onChange: event => setSearchQ(event.target.value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, \"events: \"), isLoading ? __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }, \"loading...\") : allEvents.map(event => __jsx(EventThumbnail, {\n    key: event.id,\n    id: event.id,\n    time: event.time,\n    title: event.title,\n    creator: event.creator,\n    guests: event.guests,\n    type: event.type,\n    location: event.location,\n    comments: event.comments,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  })), __jsx(PageNumberButtonWrapper, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }, \"Select page:\"), pageButtons(), __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  }, \"Items per page:\"), __jsx(SearchParamButton, {\n    isSelected: pageSize === 5,\n    onClick: () => setPageSize(5),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }, \"5\"), __jsx(SearchParamButton, {\n    isSelected: pageSize === 15,\n    onClick: () => setPageSize(15),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, \"15\"), __jsx(SearchParamButton, {\n    isSelected: pageSize === 22,\n    onClick: () => setPageSize(25),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }, \"25\")));\n};\n\nexport default Search;","map":{"version":3,"sources":["/Users/mj/repo/siliconrhino/components/search/Search.tsx"],"names":["styled","useState","useEffect","DebounceInput","axios","EventThumbnail","SearchWrapper","div","SearchParamButton","props","isSelected","SearchInput","PageNumberButtonWrapper","Search","pageNo","selectPageNo","pageSize","setPageSize","searchQ","setSearchQ","allEvents","setEvents","isLoading","setLoading","isError","setError","eventsNo","setEventsNo","totalPages","setTotalPages","createPagination","data","page","r","get","push","length","Math","floor","getEvents","res","evnts","err","pageButtons","buttons","i","event","target","value","map","id","time","title","creator","guests","type","location","comments"],"mappings":"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","sourcesContent":["import styled from 'styled-components'\nimport { useState, useEffect } from 'react'\nimport {DebounceInput} from 'react-debounce-input'\nimport axios from 'axios'\nimport { Event } from '../../pages/e/event.types'\nimport EventThumbnail from '../event/EventThumbnail'\n\nconst SearchWrapper = styled.div`\n`\n\nconst SearchParamButton = styled.div<{isSelected: boolean}>`\n  display: grid;\n  justify-content: center;\n  place-items: center;\n  font-weight: bold;\n  border: 1px solid black;\n  background: ${(props) => props.isSelected ? 'aqua' : 'none'};\n`\n\nconst SearchInput = styled(DebounceInput)`\n  width: 50%;\n  border: 1px solid black;\n`\n\nconst PageNumberButtonWrapper = styled.div`\n  display: flex;\n  justify-content: space-around;\n`\n\n\n\nconst Search = () => {\n  const [pageNo, selectPageNo] = useState(0)\n  const [pageSize, setPageSize] = useState(5)\n  const [searchQ, setSearchQ] = useState('')\n  const [allEvents, setEvents] = useState<Event[]>([])\n  const [isLoading, setLoading] = useState(false)\n  const [isError, setError] = useState(false)\n  const [eventsNo, setEventsNo] = useState(0)\n  const [totalPages, setTotalPages] = useState(1)\n\n  /**\n   * the API does not return total number of items so in order to create proper pagination this have to be done manually\n   */\n  const createPagination = async () => {\n    let data = [];\n    let page = 1;\n    while(true) {\n      const r = await axios.get(`https://mock-api.drinks.test.siliconrhino.io/events?page=${page}&pageSize=5`);\n      page++;\n      data.push(...r.data);\n      if(r.data.length === 0) {\n        setEventsNo(data.length)\n        break;\n      }\n    }\n    setTotalPages(Math.floor(eventsNo / pageSize) + 1)\n  }\n\n  useEffect(() => {\n    createPagination();\n  }, [])\n\n  useEffect(() => {\n    getEvents()\n  }, [pageSize, pageNo, searchQ])\n\n  useEffect(() => {\n    setTotalPages(Math.floor(eventsNo / pageSize) + 1)\n  }, [pageSize])\n\n  const getEvents = async () => {\n    setLoading(true)\n    try {\n      const res = await axios.get(`https://mock-api.drinks.test.siliconrhino.io/events?page=${pageNo}&pageSize=${pageSize}&search=${searchQ}`)\n      const evnts: Event[] = res.data\n      setEvents(evnts)\n      setLoading(false)\n    }\n    catch (err) {\n      setLoading(false)\n      setError(true)\n    }\n  }\n\n  useEffect(() => {}, [])\n  if (isError) {\n    return (\n      <div>Failed to load data.</div>\n    )\n  }\n\n  const pageButtons = () => {\n    let buttons: JSX.Element[] = []\n    for (let i = 0; i < totalPages; i++) {\n      buttons.push(\n        <SearchParamButton isSelected={pageNo === i} onClick={() => selectPageNo(i)}>{i+1}</SearchParamButton>\n      )\n    }\n    return buttons\n  }\n\n  return (\n    <SearchWrapper>\n      <SearchInput\n        minLength={1}\n        debounceTimeout={300}\n        placeholder={'asdf'}\n        //@ts-ignore\n        onChange={event => setSearchQ(event.target.value)}\n      />\n      <div>events: </div>\n      {\n        isLoading ?\n        <div>loading...</div>\n      :\n        allEvents.map((event) => (\n          <EventThumbnail\n            key={event.id}\n            id={event.id}\n            time={event.time}\n            title={event.title}\n            creator={event.creator}\n            guests={event.guests}\n            type={event.type}\n            location={event.location}\n            comments={event.comments}\n          />\n        ))\n      }\n      <PageNumberButtonWrapper>\n        <div>Select page:</div>\n        {pageButtons()}\n        <div>Items per page:</div>\n        <SearchParamButton isSelected={pageSize === 5} onClick={() => setPageSize(5)}>5</SearchParamButton>\n        <SearchParamButton isSelected={pageSize === 15} onClick={() => setPageSize(15)}>15</SearchParamButton>\n        <SearchParamButton isSelected={pageSize === 22} onClick={() => setPageSize(25)}>25</SearchParamButton>\n      </PageNumberButtonWrapper>\n    </SearchWrapper>\n  )\n}\n\nexport default Search"]},"metadata":{},"sourceType":"module"}